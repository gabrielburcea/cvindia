---
title: "R Notebook"
output: html_notebook
---




# Introduction 

I have undertaken several steps in modeling: 
- I have looked at age variable and compared it to the comorbidities, thus attempting to find some age band groupings 
- I have added counts of gender as well as patients that declare whether they are covid tested negative, positive or showing symptoms of covid (that never been tested)
- added a correlation matrix 
- I have used stepwise logistic regression , with forward method(see Appendices) 
- taken out covid_tested variable and fatigue (as it seems to be correlated with muscle ache - the highest score (0.453) yet not even reaching 0.50; But took it out from the analysis
- I, then build the final model based on stepwise logistic model output
- I have computed the odd ratios 
- I have computed the confidence intervals
- I have also reported the findings just to check whether I write well the findings
- however, not sure whether I shall report age - how to report them as I am trying to understand more on how to group age and age bands
- 

Yet, what I have to consider is: 
- adjusting for multiple testing?
- variance inflation factor (some are even calling this multiconlinearity but not sure of myself)?
- and the last stage would be comparing the findings between all models
- but also trying to understand the concept of confounders in health statistics 


# Exploring the data 

Age variable may not fit the model well. Therefore, I am calculating the percentages of age with comorbidities and see whether I can spot any age groups. I have 9 comorbidities and will take age and calculate the percentages. Obesity, diabetes type I and II, asthma, hypertension, heart_disease, lung condition, liver disease and kidney disease are the variables that would be calculated against age with the purpose of whether we can spot different age bands. Yet, analysis revealed different age bands based on observations made when observed towards different comorbidity groups. Yet, if I choose different age bands are these, then comparable? I thought it is worth keeping similar age bands across different models for the sake of comparability?I I will therefore, keep the age bands as 0-20, 21-30, 31 - 40, 41 -50, 51-60, 61-70, 71-80, 81-100, for the sake of comparability. But I have to check with more collegues on this. 

# Obesity by age. 

The plot suggests some groups. From 0-20 we have first group since no obese in this group. However, with the increase of obesity from 20 years old to approx 40, starts decreasing fro 40 towards 50 and 60 years of age. However, from aprox 60 to 80 it is show less obesity, with 80 to 100 no obesity. Therefore, the age groups are 0-20, 21-40, 41-50, 51-60, 61-70, 71-80, 80-100. 

```{r}
# Calculate the percentage of obese respondents across age in my dataset
obesity_age <- data_categ_nosev %>%
   dplyr::select(age_rec, obesity) %>%
  dplyr::filter(obesity == "Yes") %>%
  group_by(age_rec) %>%
  tally() %>%
  dplyr::mutate(Percentage = n/sum(n))

obesity_age
plot(obesity_age$age_rec, obesity_age$Percentage)
```

# Diabetes type I
I have hard time to see a pattern into this plot. 

```{r}

# Diabetes type I 

diabetes_age <- data_categ_nosev %>%
   dplyr::select(age_rec, diabetes_type_one) %>%
  dplyr::filter(diabetes_type_one== "Yes") %>%
  group_by(age_rec) %>%
  tally() %>%
  dplyr::mutate(Percentage = n/sum(n))
diabetes_age

#plot
plot(diabetes_age$age_rec, diabetes_age$Percentage)


```

# Diabetes type II
As the plot suggests, following groups may be formed, 0-20, 30-60, 60-70, 70-100.

```{r}

# Diabetes type II

diabetes_two <- data_categ_nosev %>%
  dplyr::select(age_rec, diabetes_type_two) %>%
  dplyr::filter(diabetes_type_two == "Yes") %>%
  group_by(age_rec) %>%
  tally() %>%
  dplyr::mutate(Percentages = n/sum(n))

# plot
plot(diabetes_two$age_rec, diabetes_two$Percentages)
```

# Asthma
are 0-20, 21-30, 31-40, 41-50, 51-60, 61-70, 71-80, 81-100. 

```{r}
# Asthma and age

asthma_age <- data_categ_nosev %>%
  dplyr::select(age_rec,asthma) %>%
  dplyr::filter(asthma == "Yes") %>%
  group_by(age_rec) %>%
  tally() %>%
  dplyr::mutate(Percentages = n/sum(n))

asthma_age
# plot
plot(asthma_age$age_rec, asthma_age$Percentages)
```
# Hypertension
Hypertension and age shows similarities with previous plots. Therefore, the age_bands are 0-20, 21-40, 41-60, 61-70, 71-80, 81-100. 

```{r}
# Hypertension and age 
hyperthension_age <- data_categ_nosev %>%
  dplyr::select(age_rec,hypertension) %>%
  dplyr::filter(hypertension == "Yes") %>%
  group_by(age_rec) %>%
  tally() %>%
  dplyr::mutate(Percentages = n/sum(n))

hyperthension_age
# plot
plot(hyperthension_age$age_rec, hyperthension_age$Percentages)
```

# Heart disease

Heart disease by age. The plot reveals different groups - 0-20, 21-60, 60-80, 80-100. 

```{r}

# Heart and age 
heart_disease_age <- data_categ_nosev %>%
  dplyr::select(age_rec,heart_disease) %>%
  dplyr::filter(heart_disease == "Yes") %>%
  group_by(age_rec) %>%
  tally() %>%
  dplyr::mutate(Percentages = n/sum(n))
heart_disease_age

# plot
plot(heart_disease_age$age_rec, heart_disease_age$Percentages)

```


# Lung condition
Lung condidition by age.Groups emerging such as 0-20, 21-30, 31-40, 41-60, 61-70, 71-80, 80-100. 

```{r}

# Lung conditions and age 
lunc_cond_age <- data_categ_nosev %>%
  dplyr::select(age_rec,lung_condition) %>%
  dplyr::filter(lung_condition == "Yes") %>%
  group_by(age_rec) %>%
  tally() %>%
  dplyr::mutate(Percentages = n/sum(n))

# plot
plot(lunc_cond_age$age_rec, lunc_cond_age$Percentages)

```

# Liver disease 

group age that may emerge are 20-40, 40-50; 50-70, 70-100

```{r}
# Liver disease and age 
liver_disease_age <- data_categ_nosev %>%
  dplyr::select(age_rec,liver_disease) %>%
  dplyr::filter(liver_disease == "Yes") %>%
  group_by(age_rec) %>%
  tally() %>%
  dplyr::mutate(Percentages = n/sum(n))

# plot liver disease 
plot(liver_disease_age$age_rec, liver_disease_age$Percentages)
```

# Kidney disease 
groups revealed are 0-20; 21-30, 30-60 70?, 70-100. 

```{r}

kidney_disease_age <- data_categ_nosev %>%
  dplyr::select(age_rec,kidney_disease) %>%
  dplyr::filter(kidney_disease == "Yes") %>%
  group_by(age_rec) %>%
  tally() %>%
  dplyr::mutate(Percentages = n/sum(n))

# plot liver disease 
plot(kidney_disease_age$age_rec, kidney_disease_age$Percentages)

```

# Conclusion 

I have different groups for different comorbidities for filtered data. It seems some comorbidities do not reveal a pattern. I would wait for more data to come in so that I will capture well the age groups on the new dataset. Yet, on the present dataset, analysis will use age as it is, without age band. 


```{r}
# Recoding age as some respondents are randomly choosing age above 200 
data_categ_nosev <- data_categ_nosev %>%
  dplyr::mutate(age_rec = replace(age, age > 100, NA_real_)) %>%
  drop_na()

data_categ_nosev %>% 
  distinct(temperature)

data_categ_nosev <- data_categ_nosev %>%
  dplyr::mutate(age_band = dplyr::case_when(
    age_rec == 0 | age_rec <= 20 ~ '0-20',
    age_rec == 21 | age_rec <= 30 ~ '21-30',
    age_rec == 31 | age_rec <= 40 ~ '31-40',
    age_rec == 41 | age_rec <= 50 ~ '41-50',
    age_rec == 51 | age_rec <= 60 ~ '51-60',
    age_rec == 61 | age_rec <= 70 ~ '61-70',
    age_rec == 71 | age_rec <= 80 ~ '71-80',
    age_rec == 81 | age_rec <= 90 ~ '81-100'))


data_categ_nosev <- data_categ_nosev %>%
  dplyr::mutate(temperature= dplyr::case_when(
    temperature == "No" ~ '37', 
    temperature == "37.5-38" ~ "37.5-38",
    temperature == "38.1-39" ~ "38.1-39",
    temperature == "39.1-41" ~ "39.1-41"
  ))


temp_rec <- data_categ_nosev %>% 
  distinct(temperature)

temp_rec
```



